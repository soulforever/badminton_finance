# Badminton Finance
---

快速开始吧
--------------------------------------------------

### 1. 准备工作 ready？

- ```Python``` 解释器版本为2.7.6
- 这个小程序的入口是主文件夹下面的```run.py```
- 输入和输出在```data```文件夹下（当然你可以随意修改，后面会提到如何去做）

### 2. 先运行起来 go～

最简单的方法是这样运行它：
```shell
$ python run.py
```
如果是类Unix系统，还可以这样：
```shell
$ ./run.py
```
好像什么都没有做一样是吧。别着急，打开```data```文件夹，```output.txt```里面已经有了输出：
```txt
[Summary]

2016-06-02 20:00~22:00 +210 -240 -30
2016-06-03 09:00~12:00 +420 -180 +240
2016-06-04 14:00~17:00 +660 -600 +60
2016-06-05 19:00~22:00 +0 -0 0
2016-06-06 12:00~15:00 +450 -300 +150
2016-06-07 15:00~17:00 +360 -200 +160
2016-06-08 10:00~13:00 +570 -330 +240
2016-06-09 16:00~18:00 +480 -300 +180
2016-06-10 20:00~22:00 +150 -120 +30
2016-06-11 13:00~15:00 +330 -200 +130

Total Income: 3630
Total Payment: 2470
Profit: 1160
```
那么输入的是什么数据呢，它就是```data```文件夹下的```input.txt```。打开看看？
```txt
2016-06-02 20:00~22:00 7
2016-06-03 09:00~12:00 14
2016-06-04 14:00~17:00 22
2016-06-05 19:00~22:00 3
2016-06-06 12:00~15:00 15
2016-06-07 15:00~17:00 12
2016-06-08 10:00~13:00 19
2016-06-09 16:00~18:00 16
2016-06-10 20:00~22:00 5
2016-06-11 13:00~15:00 11
```
这里每一行的输入，其实是这样构成的：
```txt
{date} {start_time}-{end_time} {applicants}
{日期} {起始时间}-{结束时间} {申请人数}
```
输出的自然是每次赚的钱和总共转的钱啦。
只不过这里的时间都是整点，0.0～

### 3. 观察一下文件 瞄一眼-_-！
```txt
├── badminton_finance
│   ├── core.py
│   ├── helpers.py
│   └── __init__.py
├── test
├── data
├── docs
├── LICENSE
├── README
├── config.py
└── run.py
```

- ```run.py```是入口程序(这个已经说过了)， ```data```里面是输入输出的文件(这个也说过了)。
- ```test```就是做测试啦，```docs```里面是文档，这很好理解。
- ```README```就是这里看到的文档，```LICENSE```嗯～反正得有一个装装样子。
-  ```config.py```重头戏来了，这里可以配置一些运行的方式和特点，下面着重说说它。


改变运行的轨(can)迹(shu)
--------------------------------------------------
### 1. 直接改配置文件

为了方便更多的需求， ```congfig```提出了以下的配置项。先打开看看：
```python
# 使用文件输入还是用手打
INPUT_TYPE = 'file'

# 要不要严格的检查输入，要的话费时间，不要的话会抛一些错误出来
# 所以如果保证数据格式没问题，设它False也不是不可以
IS_CHECK = True

# 是不是用生成器，输入文件很大就True，小文件毛毛雨就False
IS_GENERATOR = True

# 输出是不是打在屏幕上，不打在屏幕上就写到那个output.txt了
IS_PRINT = False

# 这是个默认的输入输出文件路径，高兴的话就改
INPUT_FILE_PATH = 'data/input.txt'
OUTPUT_FILE_PATH = 'data/output.txt'

# 其实没什么用的玩意，用手打输入的时候的退出键
QUIT_FLAGS = ('q', 'quit', 'exit', 'Q', 'Quit', 'Exit', 'QUIT', 'EXIT')
```
这里改了后，配置就是持久的。但**不一定**就是按照这样的方式运行，原因在下一个小节。

### 2. 命令行的参数

如果配置好了配置文件，但是某一次执行的时候一拍大腿，就想把文件输出到```～/prefer_place/i_like_this.txt```里面。又要去配置文件修改吗，好烦～

其实只要运行的时候带上参数就行了，就像上面的例子：
```shell
$ python run.py -o ～/prefer_place/i_like_this.txt
```
还有那些参数可以用呢， 运行一个带```-h```的命令就可以知道了：
```shell
$ python run.py -h
usage: Badminton Finance [-h] [-v] [-o OUTPUT] [-i INPUT] [-t {file,terminal}]
                         [-s]

optional arguments:
  -h, --help            帮助，就像现在这样
  -v, --version         版本
  -o OUTPUT, --output OUTPUT
                        输出到哪个文件
  -i INPUT, --input INPUT
                        从哪个文件输入
  -t {file,terminal}, --type {file,terminal}
                        用文件输入还是手打
  -s, --screen          结果打印到屏幕
```
***小Tips***：这里同一行```-s，--screen```代表这俩都行；```-t {file,terminal}```指的是你只能用这两个作为输入；其实并不是所有```config.py```里的参数都有，这里主要是常用的。

**小重点**： 命令行设置的参数，优先级比```config.py```要高。

满足不了你的任(xu)性(qiu)
--------------------------------------------------

### 1. 修改机制
其实这个程序的最关键的两个数据都在```helpers.py```里面：
```
ODER_STRATEGY = {
    # ...
}

CHARGE_STRATEGY = {
    # ...
}
```

它们分别表示了：有多少人怎么知道订多少个场，在每个时间段要给羽毛球场交多少钱。

***小TIPS***：对于```ODER_STRATEGY```，```helpers.py```里面会做一个中等强度的检查。

**小重点**： 请小心修改```CHARGE_STRATEGY```，他和```_RE_*```的参数会有勾结；一定要布满整个时间轴，否则要重写最核心的计算函数了。

### 2. 还有的细节呢

多说无益，在```docs/build/html```这个路径下面，有个这样的这样的文件：```index.html```。

用浏览器打开后，会有各个模块的文档。不过生成这个需要在```docs```路径下build一下：
```shell
$ make html
```

### 3. 怎么测试

如果修改了运行逻辑，可以参考```test```模块下面的测试用例。

当然，如果彻底修改了输出逻辑，这里的用例也要伴随修改咯～

继续做个更好的版本
--------------------------------------------------

不太满意的地方还有很多，比如说：

- 时间暂时只能整点
- 需不需要打个日志什么的

当然，想的太多也不好，万一需求又变了呢～QAQ
